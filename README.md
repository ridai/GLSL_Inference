# GLSL_Inference
GLSLを使って、オレオレTensorflow.jsを作って、推論処理を実装してみる

## 目的
- フラグメントシェーダーの記述言語として、GLSLを学んでみる
- GLSLでの処理をハックして、テンソル計算をやってみる
- テンソル計算ができるようになったら、機械学習の推論処理を行う仕組みを作ってみる

## WebGLって？
ブラウザからGPUリソースにアクセスして、レンダリング処理を行うためのJavaScript API。
GPUのレンダリング処理には、シェーダーと呼ばれる機能を用いている。

### シェーダー
そもそも、GPUは一般的に3Dのオブジェクトに対して、以下の2フェーズの処理を行なっている。
- 頂点パイプライン
  - 頂点シェーダー
    - 頂点/面単位での陰影処理
  - テッセレーション
    - LOD(Level Of Details)処理として、頂点の分割計画/分割/意味付けを行う
  - ジオメトリシェーダ
    - 頂点の増減を動的に実施
- ピクセルパイプライン
  - フラグメントシェーダー（ピクセルシェーダー)
    - ピクセル単位の陰影処理
    - テクスチャの適用
  - レンダーバックエンド
    - ステンシル処理等

上記処理の詳細は割愛するが、昔は全てハードウェアでカバーされ、機能のUpdateと共にハードウェアの買い替えが必要であった。
近年は、機能はプログラムで定義できるようになり、ユーザー起点でさまざまな3D/2D表現ができるようになった（プログラマブルシェーダー）

## GLSLって？
フラグメントシェーダー部分の記述が可能なC言語ベースの言語。

実装内容としては、描画する2D画面の各ピクセル単位に、テクスチャ適用、陰影計算を行い、実際の色を出力するための定義を行う。
ピクセル単位の膨大な計算が必要ではあるが、GPUの力を使うことで並列・高速化を実現させる。

## GLSLを使ってテンソル計算するとは？
普通、GLSLではピクセル単位にテクスチャを適用し、光源や法線マップに従った陰影処理を行う。

中でも、テクスチャを適用する処理に着目する。
テクスチャ自体は、色情報(RGBa)を定義する2次元の配列データであるため、このデータをテンソル計算の入力と見立てる。
そして、テクスチャの乗算処理を行う行うことで、テンソル計算と同等の結果を得る。

![20180504182318](https://user-images.githubusercontent.com/2268153/153717658-311ec0a1-95e9-4010-8849-aaf678bc2a09.png)

当然、GPUによる並列・高速化の恩恵が得られるため、普通にJavaScriptで計算を実装するよりも高速になることが期待できる、という算段である。

### 参考
Tensorflow.jsではどうやってWebGLを利用しているのか？
→ https://tfujiwar.hatenablog.com/entry/2018/05/21/120815


